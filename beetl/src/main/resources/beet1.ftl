{"search_type":"query_then_fetch","ignore_unavailable":true,"index":${index}}
{"size":0,"query":{"bool":{"filter":[{"range":{"@timestamp":{"gte":"1547913600000","lte":"1547999999999","format":"epoch_millis"}}}<% if(_temp != '*'){ %>,{"a":"${c}"} <% } %>,{"query_string":{"analyze_wildcard":true,"query":"@hostname:(\"server\\20\"OR\"server\\\"21\"OR\"server\\-5\"OR\"server\\/4\"OR\"server1\"OR\"server2\"OR\"server3\")"}}],"must":[{"match_phrase":{"@hostname":{"query":"server3"}}}]}},"aggs":{"3":{"terms":{"field":"@hostname","size":5,"order":{"1":"asc"},"min_doc_count":1},"aggs":{"1":{"max":{"field":"@value"}},"2":{"date_histogram":{"interval":"1m","field":"@timestamp","min_doc_count":0,"extended_bounds":{"min":"1547913600000","max":"1547999999999"},"format":"epoch_millis"},"aggs":{"1":{"max":{"field":"@value"}}}}}}}}
<% if(_temp != '*'){ %>,{"a":"${c}"} <% } %>